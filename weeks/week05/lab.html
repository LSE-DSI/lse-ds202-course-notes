<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xiaowei Gao">
<meta name="dcterms.date" content="06 October 2022">

<title>üíª Week 05 - Lab Roadmap (90 min)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="lab_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab_files/libs/quarto-html/quarto.js"></script>
<script src="lab_files/libs/quarto-html/popper.min.js"></script>
<script src="lab_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">üíª Week 05 - Lab Roadmap (90 min)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xiaowei Gao </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 6, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>
</p><p>Last week we learnt how to do the Classification Methods in R. As data scientists, we need to know how to examine the results we generated and also to justify our results. So, we will focus on and practice the validation methods in the R language in this week‚Äôs lab.</p>
<p>If you feel confident at the current stage, free to explore more on your own. We have provided you with some supplementary online resources :</p>
<p><br> üëâ <a href="https://rforanalytics.com/13.6-k-fold-cross-validation.html">R for Data Analytics</a> (part of the courses by Abhay Singh)</p>
üëâ <a href="https://r4ds.had.co.nz/index.html">R for Data Science</a> (book by Hadley Wickham &amp; Garrett Grolemund)
<p></p>
<details>
<summary>
Step 1: The Validation Set Approach (15mins)
</summary>
<p><br> In this step, we will explore how to extract the subset of the whole dataset as a training dataset, and then estimate the test error rates of various linear models. The dataset is <code>Auto</code> from the <code>ISLR2</code> package.</p>
<ol type="1">
<li><p>Split the <code>Auto</code> dataset into two halves, as randomly selecting 196 observations out of the original 392 observations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(ISLR2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">392</span>, <span class="dv">196</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Please note that, the <code>set.seed()</code> is important here as it set a <strong>seed</strong> for the random number generator. Literally, the same results will be replicated in the following steps. Further information can be found in the official documentation.<a href="https://www.rdocumentation.org/packages/simEd/versions/2.0.0/topics/set.seed">Seeding Random Variate Generators</a> Also, I provide some details to help you understand this function in the following part.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">3</span>) <span class="co"># randomly generate three numbers</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]Ôºö<span class="sc">-</span><span class="fl">0.5604756</span> <span class="sc">-</span><span class="fl">0.2301775</span>  <span class="fl">1.5587083</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">3</span>) <span class="co">#try to replicate the result from x, but totally different</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]Ôºö<span class="fl">0.07050839</span> <span class="fl">0.12928774</span> <span class="fl">1.71506499</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">3</span>) <span class="co">#try to replicate the result from x again with the same seed</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]Ôºö<span class="sc">-</span><span class="fl">0.5604756</span> <span class="sc">-</span><span class="fl">0.2301775</span>  <span class="fl">1.5587083</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Fit a linear regression model using the training dataset (<code>train</code>), making the <code>mpg</code> as the dependent variable(x) and <code>horsepower</code> as the independent variable(y). Then, using the fitted model to estimate the <code>mpg</code> from the whole dataset, <code>Auto</code>. Finally, calculating the MSE of the 196 observations in the validation set.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the lm() function to fit a linear regression model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> Auto, <span class="at">subset =</span> train)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the 'mpg' values by the lm.fit model</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> lm.pre <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.fit, Auto)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">attach</span>(Auto)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mean</span>((mpg <span class="sc">-</span> lm.pre)[<span class="sc">-</span>train]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">23.27</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Therefore, we have estimated the test MSE for the linear regression model, <strong>23.27</strong>. (Well Done! üí™ ) <br> Please note, here we use new functions, namely <code>lm</code>, <code>predict</code>,and <code>attach</code>. By typing <code>?</code>, you can find the official explanation of these functions. We just want to point out <code>attach</code>, which will make your coding easier without quoting <code>dataframe$colnames</code>.</p>
<p>‚ö°Ô∏èThe <code>-train</code> index selects only the observations that are not in the training set.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">attach</span>(Auto)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] You can see all the values from the <span class="st">'mpg'</span> column.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However, if you do not use <code>attach</code> to call the dataframe, you have to use the <code>$</code> function to have the same results.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Auto<span class="sc">$</span>mpg</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] You can see all the values from the <span class="st">'mpg'</span> column.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Repeat the second part to estimate the test error for the quadratic and cubic regressions.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> lm.fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg ‚àº <span class="fu">poly</span>(horsepower, <span class="dv">2</span>), <span class="at">data =</span> Auto, <span class="at">subset =</span> train)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mean</span>((mpg <span class="sc">-</span> <span class="fu">predict</span>(lm.fit2, Auto))[<span class="sc">-</span>train]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">18.72</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> lm.fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg ‚àº <span class="fu">poly</span>(horsepower, <span class="dv">3</span>), <span class="at">data =</span> Auto, <span class="at">subset =</span> train)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mean</span>((mpg <span class="sc">-</span> <span class="fu">predict</span>(lm.fit3, Auto))[<span class="sc">-</span>train]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">18.79</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By far, we have got the MSE for the quadratic and cubic regressions. Hence, we can see a model that predicts <code>mpg</code> using a quadratic function of <code>horsepower</code> performs better than a model that involves only a linear function of <code>horsepower</code>, and there is little evidence in favor of a model that uses a cubic function of <code>horsepower</code>.</p></li>
</ol>
</details>
<details>
<summary>
Step 2: Leave-One-Out Cross-Validation (15mins)
</summary>
<p><br> Hereby, We will compute the LOOCV values by using the function <code>glm</code> rather than <code>lm</code>.</p>
<ol type="1">
<li><p>Generate the cross-validation results with the generalized linear model.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(boot)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the glm model</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> glm.fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(mpg ‚àº horsepower, <span class="at">data =</span> Auto)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get the information about the model</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(glm.fit)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] Call<span class="sc">:</span> <span class="fu">glm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> Auto)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    Deviance Residuals<span class="sc">:</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        Min        1Q    Median        3Q       Max  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">13.5710</span>   <span class="sc">-</span><span class="fl">3.2592</span>   <span class="sc">-</span><span class="fl">0.3435</span>    <span class="fl">2.7630</span>   <span class="fl">16.9240</span>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    Coefficients<span class="sc">:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                Estimate Std. Error t value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    (Intercept) <span class="fl">39.935861</span>   <span class="fl">0.717499</span>   <span class="fl">55.66</span>   <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    horsepower  <span class="sc">-</span><span class="fl">0.157845</span>   <span class="fl">0.006446</span>  <span class="sc">-</span><span class="fl">24.49</span>   <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">---</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    Signif. codes<span class="sc">:</span>  <span class="dv">0</span> ‚Äò<span class="sc">**</span><span class="er">*</span>‚Äô <span class="fl">0.001</span> ‚Äò<span class="sc">**</span>‚Äô <span class="fl">0.01</span> ‚Äò<span class="sc">*</span>‚Äô <span class="fl">0.05</span> ‚Äò.‚Äô <span class="fl">0.1</span> ‚Äò ‚Äô <span class="dv">1</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    (Dispersion parameter <span class="cf">for</span> gaussian family taken to be <span class="fl">24.06645</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        Null deviance<span class="sc">:</span> <span class="fl">23819.0</span>  on <span class="dv">391</span>  degrees of freedom</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    Residual deviance<span class="sc">:</span>  <span class="fl">9385.9</span>  on <span class="dv">390</span>  degrees of freedom</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    AIC<span class="sc">:</span> <span class="fl">2363.3</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    Number of Fisher Scoring iterations<span class="sc">:</span> <span class="dv">2</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># get the cross-validation results by the 'cv.glm' function</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv.err <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(Auto, glm.fit)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv.err<span class="sc">$</span>delta</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]   <span class="dv">1</span>   <span class="dv">1</span> </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>   <span class="fl">24.23</span> <span class="fl">24.23</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co"># explore cv.err </span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(cv.err)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]       Length Class  Mode   </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    call    <span class="dv">3</span>    <span class="sc">-</span>none<span class="sc">-</span> call   </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    K       <span class="dv">1</span>    <span class="sc">-</span>none<span class="sc">-</span> numeric</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    delta   <span class="dv">2</span>    <span class="sc">-</span>none<span class="sc">-</span> numeric</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    seed  <span class="dv">626</span>    <span class="sc">-</span>none<span class="sc">-</span> numeric</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Please be aware that, The <code>cv.glm()</code> function is part of the <code>boot</code> library. Meanwhile, you can explore the <code>cv.err</code> by yourself to see what is the meaning of <code>call</code>,<code>K</code>,<code>delta</code> and <code>seed</code>. This online webpage will be useful when interpreting the results. <a href="https://stats.stackexchange.com/questions/48766/intepretation-of-crossvalidation-result-cv-glm">Intepretation of crossvalidation result</a></p>
<p>üèãÔ∏è There is a bonus for the senior students. You can explore the package <code>caret</code> for the LOOCV estimation.</p></li>
<li><p>Repeat the former step and fit increasingly complex polynomial models</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crate a vactor with length equal to 10</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv.error <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>) </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  glm.fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, i), <span class="at">data =</span> Auto)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  cv.error[i] <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> Auto, <span class="at">glmfit =</span> glm.fit)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#check the cv.error </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv.error</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">24.23151</span> <span class="fl">19.24821</span> <span class="fl">19.33498</span> <span class="fl">19.42443</span> <span class="fl">19.03321</span> <span class="fl">18.97864</span> <span class="fl">18.83305</span> <span class="fl">18.96115</span> <span class="fl">19.06863</span> <span class="fl">19.49093</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>rep</code> means repeat. In this line, we can also use <code>cv.error &lt;- numeric(10)</code> to get the same result. <br> <strong>It does not matter whether we have rep(0,10) or rep(1,10). We only want to get a vector with a length of 10.</strong> You can think of the reason by yourself. <br> We hereby use the <code>for</code> loop to iterate the number from 1 to 10, and store the first <code>delta</code> number to the <strong>i</strong> th position of <code>cv.error</code>.</p>
<p>I would also encourage you to basically visualise the results, as <code>plot(cv.error)</code>. We can clearly see a sharp drop in the estimated test MSE between the linear and quadratic fits, from 24.27 to 19.27, but then no clear improvement from using higher-order polynomials.</p></li>
</ol>
</details>
<details>
<summary>
Step 3: k-Fold Cross-Validation (5mins)
</summary>
<p><br> It will be easy to follow the former procedure in Step 2, by the <code>cv.glm</code> to implement <strong><em>K-fold</em></strong> CV.</p>
<ol type="1">
<li><p>Estimate CV errors corresponding to the polynomial fits of orders one to ten.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv.error<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">100</span>, <span class="dv">10</span>) </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  glm.fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, i), <span class="at">data =</span> Auto)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  cv.error<span class="fl">.10</span>[i] <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> Auto, <span class="at">glmfit =</span> glm.fit, <span class="at">K=</span><span class="dv">10</span>)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cv.error<span class="fl">.10</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">24.27207</span> <span class="fl">19.26909</span> <span class="fl">19.34805</span> <span class="fl">19.29496</span> <span class="fl">19.03198</span> <span class="fl">18.89781</span> <span class="fl">19.12061</span> <span class="fl">19.14666</span> <span class="fl">18.87013</span> <span class="fl">20.95520</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that in the line of <code>cv.error.10[i] &lt;- cv.glm(data = Auto, glmfit = glm.fit, K=10)$delta[1]</code>, it will be very strict to <code>K</code> rather than <code>k</code>.</p></li>
</ol>
</details>
<details>
<summary>
Step 4: The Bootstrap (20mins)
</summary>
<p><br> We have learnt the theoretical method regarding Bootstrap. I understand there may be a bit difficult for beginners in statistics, but we will mainly focus on the coding implementation here. Two datasets will be used, <code>Portfolio</code> from the <code>ISLR2</code> package, and also the <code>Auto</code> dataset. So please ensure you have called the <code>library(ISLR2)</code> at the very first beginning. Also, we will introduce how to create a <code>funcion</code> below.</p>
<p><strong>Functions are ‚Äúself contained‚Äù modules of code that accomplish a specific task.</strong> referenced from <a href="https://hbctraining.github.io/Intro-to-R/lessons/03_introR-functions-and-arguments.html">Functions and theri argumens</a> <br></p>
<p>With the help of a function, you can reuse the same pattern codes with a simple function name.</p>
<section id="step-4.1-estimating-the-accuracy-of-a-statistic-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="step-4.1-estimating-the-accuracy-of-a-statistic-of-interest">Step 4.1 Estimating the Accuracy of a Statistic of Interest</h3>
<p><br></p>
<ol type="1">
<li><p>Explore the <strong><em>Portfolio</em></strong> data with ggplot.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fundamental view the dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">View</span>(Portfolio)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dim</span>(Portfolio)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">colnames</span>(Portfolio)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the distribution of each columns</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(Portfolio) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span> X),<span class="at">bins =</span> <span class="dv">10</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(Portfolio) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span> Y),<span class="at">bins =</span> <span class="dv">10</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the linear relationship among x and y</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(Portfolio) <span class="sc">+</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y), <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y), <span class="at">method=</span><span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You could also try to change <code>bins</code> in <code>ggplot</code>, which will help you to better understand the hist plot.</p></li>
<li><p>Create a function to estimate <span class="math inline">\(\alpha\)</span> with input from <strong>Portfolio</strong>_ data and name it as <code>alpha.fn()</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write a function</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alpha.fn <span class="ot">&lt;-</span> <span class="cf">function</span>(data, index) {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> data<span class="sc">$</span>X[index]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Y[index]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">var</span>(Y) <span class="sc">-</span> <span class="fu">cov</span>(X, Y)) <span class="sc">/</span> (<span class="fu">var</span>(X) <span class="sc">+</span> <span class="fu">var</span>(Y) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cov</span>(X, Y)) </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#use the function</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">alpha.fn</span>(Portfolio, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.576</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When you write a function, you need to clearly know three points, namely the input data (the first and second arguments in the parentheses), the processes (within the curly braces) and the results you need. <br></p>
<p>Hence, in this step, you may want to retrieve every value of X and Y within the index (the first 100 observations). Finally, you will have the estimated <span class="math inline">\(\alpha\)</span> with the processes from this function.<br>
<br></p></li>
<li><p>Randomly select the 100 observations from the whole dataset, with replacement, and produce R = 1,000 bootstrap estimates for <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We also used the function created before</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ?sample </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">alpha.fn</span>(Portfolio, <span class="fu">sample</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="at">replace =</span> T)) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.539</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the bootstrap analysis with 1000 times, and compute the resulting standard deviation for alpha</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> ?boot</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">boot</span>(Portfolio, alpha.fn, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] ORDINARY NONPARAMETRIC BOOTSTRAP</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    Call<span class="sc">:</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">boot</span>(<span class="at">data =</span> Portfolio, <span class="at">statistic =</span> alpha.fn, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    Bootstrap Statistics <span class="sc">:</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        original       bias    std. error</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    t1<span class="sc">*</span> <span class="fl">0.5758321</span> <span class="sc">-</span><span class="fl">0.001787503</span>  <span class="fl">0.08969266</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The final output shows that using the original data, <span class="math inline">\(\hat{\alpha}=0.5758\)</span>, and that the bootstrap estimate for <span class="math inline">\(\mathrm{SE}(\hat{\alpha}) = 0.0897\)</span> .</p></li>
</ol>
<p>You may find the code hard to understand, especially when we cannot fully digest the logic of bootstrap. So I would suggest we can quickly review the lecture at this stage. Please believe in ourself, you will get through the stage sooner and make the codes much clear step by step. Be patient, and be confident üíª . <br></p>
</section>
<section id="step-4.2-estimating-the-accuracy-of-a-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="step-4.2-estimating-the-accuracy-of-a-linear-regression-model">Step 4.2 Estimating the Accuracy of a Linear Regression Model</h3>
<p><br> In this step, we will use the boostrap approach to assess the variability of the coefficient estimates and predictions from a statistical learning method. <br></p>
<ol type="1">
<li><p>Create a function as <code>boot.fn()</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> boot.fn <span class="ot">&lt;-</span> <span class="cf">function</span>(data, index)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">coef</span>(<span class="fu">lm</span>(mpg ‚àº horsepower, <span class="at">data =</span> data, <span class="at">subset =</span> index)) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">boot.fn</span>(Auto, <span class="dv">1</span><span class="sc">:</span><span class="dv">392</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>](Intercept)  horsepower </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">39.9358610</span>  <span class="sc">-</span><span class="fl">0.1578447</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You may find the <code>function</code> here is a bit different with the former one. So, I provide an another option to make it the same, with curly braces.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> boot.fn<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(data, index){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    data<span class="ot">&lt;-</span> data</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> data, <span class="at">subset =</span> index)) </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Compare the results from bootstrap estimates and the standard estimates</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bootstrap with 1000 times</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">boot</span>(Auto, boot.fn, <span class="dv">1000</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]     ORDINARY NONPARAMETRIC BOOTSTRAP</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    Call<span class="sc">:</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">boot</span>(<span class="at">data =</span> Auto, <span class="at">statistic =</span> boot.fn, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    Bootstrap Statistics <span class="sc">:</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        original       bias    std. error</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    t1<span class="sc">*</span> <span class="fl">39.9358610</span>  <span class="fl">0.082482836</span> <span class="fl">0.847514357</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    t2<span class="sc">*</span> <span class="sc">-</span><span class="fl">0.1578447</span> <span class="sc">-</span><span class="fl">0.000988235</span> <span class="fl">0.007241942</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># standard estimates</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">summary</span>(<span class="fu">lm</span>(mpg<span class="sc">~</span> horsepower, <span class="at">data =</span> Auto))<span class="sc">$</span>coef</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]     Estimate  Std. Error   t value      <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    (Intercept) <span class="fl">39.9358610</span> <span class="fl">0.717498656</span>  <span class="fl">55.65984</span> <span class="fl">1.220362e-187</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    horsepower  <span class="sc">-</span><span class="fl">0.1578447</span> <span class="fl">0.006445501</span> <span class="sc">-</span><span class="fl">24.48914</span>  <span class="fl">7.031989e-81</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can find that in the bootstrap esimation process, <span class="math inline">\(\mathrm{SE}(\hat{\beta}_{1}) = 0.8475\)</span> and <span class="math inline">\(\mathrm{SE}(\hat{\beta}_{2}) = 0.0072\)</span> , while in the standard esimation process, <span class="math inline">\(\hat{\beta}_{Intercept}=0.7175\)</span> and <span class="math inline">\(\hat{\beta}_{horsepower}=0.0064\)</span>. You can just think why there is a difference here between the two results. Possibly, you can use the below code to visualize the linear/non-linear relationship between these two variables. It may give you some suggestions on this issue.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(Auto, <span class="fu">aes</span>(<span class="at">x=</span>mpg, <span class="at">y=</span>horsepower)) <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
</section></details>
<details>
<summary>
Step 5: Exercise (35mins)
</summary>
<p><br> Since then, we have known and implemented the coding with Cross-validation and Bootstrap. In this practical case, we will use the new dataset <code>Default</code> and also <code>Weekly</code> from the <code>ISRL</code> package. <strong>Do not forget to set a random seed before beginning your analysis.</strong></p>
<p>Some questions are listed below. You are required to try to answer these questions in pairs using R commands. We will go over the solutions once everyone has finished these questions</p>
<p>üéØ <strong>Questions</strong></p>
<ol type="1">
<li><p>For the <code>Default</code> dataset, please Split the sample set into a training set and a validation set, then fit a logistic regression model that uses <code>income</code> and <code>balance</code> to predict <code>default</code>. As following,</p>
<ol type="i">
<li><p>Use three different splits of the observations into a training set and a validation set. <br></p></li>
<li><p>Fit three multiple logistic regression models using only the training observations. <br></p></li>
<li><p>Based on the three models,obtain a prediction of default status for each individual in the validation set by computing the posterior probability of default for that individual, and classifying the individual to the <code>default</code> category if the posterior probability is greater than 0.5. <br></p></li>
<li><p>Based on the three models, compute the validation set error, which is the fraction of the observations in the validation set that are misclassified.</p></li>
</ol></li>
<li><p>For the <code>Default</code> dataset, We continue to consider the use of a logistic regression model to predict the probability of <code>default</code> using <code>income</code> and <code>balance</code> on the <code>Default</code> data set. In particular, we will now compute estimates for the standard errors of the <code>income</code> and <code>balance</code> logistic regression coefficients in two different ways: 2.1. Using the <code>bootstrap</code>, 2.2. Using the standard formula for computing the standard errors in the <code>glm()</code> function. As following,</p>
<ol type="i">
<li><p>Using the <code>summary()</code> and <code>glm()</code> functions, determine the estimated standard errors for the coefficients associated with <code>income</code> and <code>balance</code> in a multiple logistic regression model that uses both predictors. <br></p></li>
<li><p>Write a function,<code>boot.fn()</code>,that takes as input the <code>Default</code> data set as well as an index of the observations, and that outputs the coefficient estimates for <code>income</code> and <code>balance</code> in the multiple logistic regression model. <br></p></li>
<li><p>Use the <code>boot()</code> function together with your <code>boot.fn()</code> function to estimate the standard errors of the logistic regression coefficients for <code>income</code> and <code>balance</code>. Then, Create a histogram of the bootstrap parameter estimates with <code>ggplot2</code>, and also set the <code>bins=20</code>, title as <code>1,000 Bootstrap Parameter Estimates - 'balance' &amp; 'income</code>. <br></p></li>
</ol></li>
<li><p>We saw that the <code>cv.glm()</code> function can be used in order to compute the LOOCV test error estimate. However, one could compute those quantities using just the <code>glm()</code> and <code>predict.glm()</code> functions, and a for loop. You will now take this approach in order to compute the LOOCV error for a simple logistic regression model on the <code>Weekly</code> data set. As following,</p>
<ol type="i">
<li><p>Logistic Regression- Fit a logistic regression model that predicts <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code>. <br></p></li>
<li><p>Omitting One Observation from Training- Fit a logistic regression model that predicts <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code> <em>using all but the first observation</em> . <br></p></li>
<li><p>Predicting the Omitted Observation- Use the model from ii. to predict the <code>direction</code> of the first observation. You can do this by predicting that the first observation will go up if <span class="math inline">\(P(\text { Direction }=' U p ' \mid \operatorname{Lag} 1, \text { Lag2 })&gt;0.5\)</span>. Was this observation correctly classified? <br></p></li>
<li><p>Writing a LOOCV Loop- Write a for loop from i = 1 to i = n, where n is the number of observations in the data set, that performs each of the following steps:</p>
<ol type="1">
<li>Fit a logistic regression model using all but the ith observation to predict <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code>.</li>
<li>Compute the posterior probability of the market moving up for the <code>i</code> th observation.</li>
<li>Use the posterior probability for the <code>i</code> th observation in order to predict whether or not the market moves up.</li>
<li>Determine whether or not an error was made in predicting the direction for the <code>i</code> th observation. If an error was made, then indicate this as a <code>1</code> , and otherwise indicate it as a <code>0</code> . <br></li>
</ol></li>
<li><p>The LOOCV Estimate for the Test Error- Take the average of the <code>n</code> numbers obtained in <code>(iv)-4</code>. in order to obtain the LOOCV estimate for the test error. Comment on the results.</p></li>
</ol></li>
</ol>
</details>


</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>